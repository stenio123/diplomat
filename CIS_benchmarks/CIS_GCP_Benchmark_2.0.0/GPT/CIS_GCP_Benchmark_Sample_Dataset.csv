text,type,order
1.1,number,1
Ensure that Corporate Login Credentials are Used (Manual),title,2
Level 1,level,3
"Audit:
For each Google Cloud Platform project, list the accounts that have been granted access to that project:
From Google Cloud CLI
gcloud projects get-iam-policy PROJECT_ID
Also list the accounts added on each folder:
gcloud resource-manager folders get-iam-policy FOLDER_ID
And list your organization's IAM policy:
gcloud organizations get-iam-policy ORGANIZATION_ID
No email accounts outside the organization domain should be granted permissions in the IAM policies. This excludes Google-owned service accounts.",audit,4
1.3,number,1
Ensure that Security Key Enforcement is Enabled for All Admin Accounts (Manual),title,2
Level 2,level,3
"Audit:
1. Identify users with Organization Administrator privileges:
gcloud organizations get-iam-policy ORGANIZATION_ID
Look for members granted the role ""roles/resourcemanager.organizationAdmin"".
2. Manually verify that Security Key Enforcement has been enabled for each account.",audit,4
4.3,number,1
Ensure “Block Project-Wide SSH Keys” Is Enabled for VM Instances (Automated),title,2
Level 1,level,3
"Audit:
From Google Cloud Console
1. GototheVMinstancespagebyvisiting https://console.cloud.google.com/compute/instances. It will list all the instances in your project.
2. For every instance, click on the name of the instance.
3. Under SSH Keys, ensure Block project-wide SSH keys is selected. From Google Cloud CLI
1. List the instances in your project and get details on each instance:
gcloud compute instances list --format=json
2. Ensure key: block-project-ssh-keys is set to value: 'true'.",audit,4
5.2,number,1
Ensure That Cloud Storage Buckets Have Uniform Bucket- Level Access Enabled (Automated),title,2
Level 2,level,3
"Audit:
From Google Cloud Console
1. Open the Cloud Storage browser in the Google Cloud Console by visiting:
https://console.cloud.google.com/storage/browser
2. For each bucket, make sure that Access control column has the value Uniform. From Google Cloud CLI
1. List all buckets in a project
gsutil ls
2. For each bucket, verify that uniform bucket-level access is enabled.
gsutil uniformbucketlevelaccess get gs://BUCKET_NAME/
If uniform bucket-level access is enabled, the response looks like:  Uniform bucket-level access setting for gs://BUCKET_NAME/: Enabled: True
    LockedTime: LOCK_DATE
",audit,4
5.1,number,1
Ensure That Cloud Storage Bucket Is Not Anonymously or Publicly Accessible (Automated),title,2
Level 1,level,3
"Audit:
From Google Cloud Console
1. Go to Storage browser by visiting https://console.cloud.google.com/storage/browser.
2. Click on each bucket name to go to its Bucket details page.
3. Click on the Permissions tab.
4. Ensure that allUsers and allAuthenticatedUsers are not in the Members list.
From Google Cloud CLI
1. List all buckets in a project
gsutil ls
2. Check the IAM Policy for each bucket:
gsutil iam get gs://BUCKET_NAME
No role should contain allUsers and/or allAuthenticatedUsers as a member.",audit,4
4.4,number,1
Ensure Oslogin Is Enabled for a Project (Automated),title,2
Level 1,level,3
"Audit:
From Google Cloud Console
1. Go to the VM compute metadata page by visiting https://console.cloud.google.com/compute/metadata.
2. Ensure that key enable-oslogin is present with value set to TRUE.
3. Because instances can override project settings, ensure that no instance has
custom metadata with key enable-oslogin and value FALSE.
From Google Cloud CLI
1. List the instances in your project and get details on each instance:
gcloud compute instances list --format=json
2. VerifythatthesectioncommonInstanceMetadatahasakeyenable-osloginsetto value TRUE.
Exception:
VMs created by GKE should be excluded. These VMs have names that start with gke- and are labeled goog-gke-node",audit,4
4.6,number,1
Ensure That IP Forwarding Is Not Enabled on Instances (Automated),title,2
Level 1,level,3
"Audit:
From Google Cloud Console
1. GototheVMInstancespagebyvisiting: https://console.cloud.google.com/compute/instances.
2. For every instance, click on its name to go to the VM instance details page.
3. Under the Network interfaces section, ensure that IP forwarding is set to Off
for every network interface.
From Google Cloud CLI
1. List all instances: gcloud compute instances list --format='table(name,canIpForward)'
2. Ensure that CAN_IP_FORWARD column in the output of above command does not contain True for any VM instance.
Exception:
Instances created by GKE should be excluded because they need to have IP forwarding enabled and cannot be changed. Instances created by GKE have names that start with ""gke-"".
",audit,4
1.6,number,1
Ensure That IAM Users Are Not Assigned the Service Account User or Service Account Token Creator Roles at Project Level (Automated),title,2
Level 1,level,3
"Audit:
From Google Cloud Console
1. GototheIAMpageintheGCPConsolebyvisiting
https://console.cloud.google.com/iam-admin/iam
2. Click on the filter table text bar, Type Role: Service Account User.
3. Ensure no user is listed as a result of the filter.
4. Click on the filter table text bar, Type Role: Service Account Token Creator.
5. Ensure no user is listed as a result of the filter.
From Google Cloud CLI
To ensure IAM users are not assigned Service Account User role at the project level: gcloud projects get-iam-policy PROJECT_ID --format json | jq '.bindings[].role' | grep ""roles/iam.serviceAccountUser""
gcloud projects get-iam-policy PROJECT_ID --format json | jq '.bindings[].role' | grep ""roles/iam.serviceAccountTokenCreator""
These commands should not return any output.",audit,4